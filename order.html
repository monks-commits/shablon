<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Замовлення квитків — Театральні квитки онлайн</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>

  <!-- Шапка -->
  <div id="site-header"></div>
  <script type="module" src="/scripts/include.js"></script>

  <main class="main">

    <section class="page-header">
      <div class="container page-header__inner">
        <h1 class="page-title">Дані для замовлення</h1>
        <p id="show-line" class="page-subtitle meta"></p>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <form id="orderForm" class="card order-form">

          <div class="form-row">
            <label for="fullname">Ім’я та Прізвище</label>
            <input
              type="text"
              id="fullname"
              name="fullname"
              required
              placeholder="Іван Іванов"
            />
          </div>

          <div class="form-row">
            <label for="email">Електронна пошта</label>
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="name@example.com"
            />
          </div>

          <div class="form-row">
            <label for="phone">Телефон</label>
            <input
              type="tel"
              id="phone"
              name="phone"
              required
              placeholder="+380..."
            />
          </div>

          <label class="checkbox">
            <input type="checkbox" name="agree" required />
            <span>
              Погоджуюсь з публічною офертою та умовами повернення.
              Перед фінальним запуском сайту вставте тут посилання на
              <a href="/public-offer.html" target="_blank">публічний договір (оферту)</a>.
            </span>
          </label>

          <button type="submit" class="btn btn--primary" id="payBtn">
            Перейти до оплати
          </button>
        </form>
      </div>
    </section>

  </main>

  <!-- Підвал -->
  <div id="site-footer"></div>

  <script>
    // Параметри з URL (передає їх hall.html)
    const p = new URLSearchParams(location.search);
    const show = p.get("show") || "";
    const title = p.get("title") || "";
    const seats = p.get("seats") || "";
    const amount = p.get("amount") || "0";
    const order_id = p.get("order_id") || ("ORD-" + Date.now());

    const showLineEl = document.getElementById("show-line");
    if (showLineEl) {
      showLineEl.textContent =
        `Вистава: ${title || show} • Місця: ${seats} • Сума: ${amount} грн`;
    }

    // На сабміт переходимо на checkout.html з усіма даними в query
    document.getElementById("orderForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const fd = new FormData(e.currentTarget);
      const fullname = (fd.get("fullname") || "").toString().trim();
      const email = (fd.get("email") || "").toString().trim();
      const phone = (fd.get("phone") || "").toString().trim();

      const u = new URL(location.origin + "/checkout.html");
      u.searchParams.set("show", show);
      u.searchParams.set("title", title);
      u.searchParams.set("seats", seats);
      u.searchParams.set("amount", amount);
      u.searchParams.set("order_id", order_id);
      u.searchParams.set("fullname", fullname);
      u.searchParams.set("email", email);
      u.searchParams.set("phone", phone);

      location.href = u.toString();
    });
  </script>

</body>
</html>
